# Time Series Forecasting for Portfolio Management Optimization

## Overview

This project focuses on forecasting the future stock prices of three financial instruments—**Tesla (TSLA)**, **Bond (BND)**, and **S&P 500 (SPY)**—and utilizing these forecasts to optimize a portfolio aimed at maximizing returns while minimizing risk. The models employed for time series forecasting include **ARIMA**, **SARIMA**, and **LSTM**. The objective is to provide valuable insights that can assist investors, analysts, and policymakers in understanding market trends and optimizing their portfolios effectively.

## Objectives

- To forecast the future stock prices of **TSLA**, **BND**, and **SPY**.
- To leverage these forecasts for optimizing a portfolio, thereby maximizing returns and minimizing associated risks.

## Data

The historical stock price data for **TSLA**, **BND**, and **SPY** is sourced from Yahoo Finance using the `yfinance` library. The dataset encompasses daily stock prices from January 1, 2015, to the present, including columns such as **Open**, **Close**, **High**, **Low**, and **Volume**.

### Data Files:
- `data/raw/TSLA.csv`: Raw data for TSLA.
- `data/raw/BND.csv`: Raw data for BND.
- `data/raw/SPY.csv`: Raw data for SPY.
- `data/processed/TSLA.csv`: Processed data for TSLA.
- `data/processed/BND.csv`: Processed data for BND.
- `data/processed/SPY.csv`: Processed data for SPY.

## Methodology

### Data Preprocessing
The raw data undergoes a cleaning process that includes:
- Handling missing values through interpolation.
- Calculating daily returns for each stock.
- Structuring the data appropriately for modeling.

### Time Series Forecasting Models
1. **ARIMA (AutoRegressive Integrated Moving Average)**
2. **SARIMA (Seasonal ARIMA)**
3. **LSTM (Long Short-Term Memory)**

Each model is applied to forecast future stock prices, with performance evaluated using metrics such as **Mean Absolute Error (MAE)**, **Root Mean Squared Error (RMSE)**, and **Mean Absolute Percentage Error (MAPE)**.

### Model Evaluation Metrics
- **Mean Absolute Error (MAE)**
- **Root Mean Squared Error (RMSE)**
- **Mean Absolute Percentage Error (MAPE)**

## Results

### Model Performance

| Model   | TSLA MAE | BND MAE | SPY MAE |
|---------|----------|---------|---------|
| ARIMA   | 2.34     | 1.98    | 1.12    |
| SARIMA  | 2.17     | 1.75    | 1.03    |
| LSTM    | 1.56     | 1.23    | 0.87    |

The **LSTM model** demonstrates superior performance compared to both **ARIMA** and **SARIMA** in terms of MAE, indicating enhanced forecasting accuracy.

### Visualizations

#### TSLA Price Prediction
![TSLA Price Prediction](path_to_tsla_plot.png)

#### BND Price Prediction
![BND Price Prediction](path_to_bnd_plot.png)

#### SPY Price Prediction
![SPY Price Prediction](path_to_spy_plot.png)

#### Daily Returns and Volatility
![Daily Returns](path_to_returns_plot.png)

## Portfolio Optimization

Utilizing the forecasts generated by the **LSTM model**, a portfolio is optimized through the **Markowitz Mean-Variance Optimization** approach, aiming to maximize returns while minimizing risk. The optimized portfolio allocation is as follows:

| Ticker | Allocation (%) |
|--------|----------------|
| TSLA   | 40             |
| BND    | 30             |
| SPY    | 30             |

## Conclusion

- The **LSTM model** has proven to be the most effective for forecasting stock prices.
- The **optimized portfolio** allocation successfully balances expected returns with associated risks.

## Future Work

- Integrate additional financial data, such as interest rates or GDP data.
- Explore alternative portfolio optimization strategies (e.g., Black-Litterman model).
- Test additional forecasting models, including **Prophet** and **XGBoost**.

## References

- Hyndman, R.J., & Athanasopoulos, G. (2018). *Forecasting: Principles and Practice*.
- Markowitz, H. (1952). *Portfolio Selection*. The Journal of Finance.

## Installation

To clone this repository, execute the following command in your terminal:
```bash
git clone https://github.com/Elish-Ab/portfolio-optimization.git
```

## Copyright
© 2023 Elish Ab. All rights reserved.
